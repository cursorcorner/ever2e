10 REM APPLESOFT PONG BY VECTRONIC
20 HOME
100 GOSUB 3000
110 X = 11: Y = 12: Z = 13: XB = 31: YB = 12: S = 0
120 COLOR= 9: PLOT X,Y: PLOT X, Z: COLOR= 13: PLOT XB,YB
130 T= PEEK (-16384)
140 IF T = 139 AND Y < > 1 THEN 300
150 IF T = 138 AND Z < > 29 THEN 400
160 IF X + 1 = XB AND Y = YB THEN 4000
170 IF X + 1 = XB AND Z = YB THEN 4000
180 IF X = XB AND Y + 1 = YB THEN 4000
190 IF X = XB AND Z + 1 = YB THEN 4000
200 IF XB = 31 THEN 2500
210 IF XB = 8 THEN 2600
220 IF YB = 29 THEN 2700
230 IF YB = 1 THEN 2800
240 IF S = 0 THEN 2900
250 IF S = 2500 THEN 2515
260 IF S = 2600 THEN 2615
270 IF S = 2700 THEN 2715
280 IF S = 2800 THEN 2815
290 IF S = 4000 THEN 4015
299 GOTO 130

300 COLOR= 0: PLOT X,Y: PLOT X,Z
310 Y = Y - 1: Z = Z -1
320 COLOR= 9: PLOT X,Y: PLOT X,Z
330 T = PEEK(-16368)
340 GOTO 130

400 COLOR= 0: PLOT X,Y: PLOT X,Z
410 Y = Y + 1: Z = Z + 1
420 IF Z = 35 THEN 130
430 COLOR= 9: PLOT X,Y: PLOT X,Z
440 T = PEEK(-16368)
450 GOTO 130

2000 REM RANDOM NUMBER GENERATOR
2100 K = INT (10*RND(1))
2200 RETURN

2300 REM RANDOM SELECTOR
2320 IF K < = 3 THEN 2370
2350 IF K > 3 AND K < 6 THEN 2380
2360 IF K > = 6 THEN 2390
2370 K = 1: GOTO 2400
2380 K = 2: GOTO 2400
2390 K = 3
2400 RETURN

2500 GOSUB 2000
2510 GOSUB 2300
2515 S = 2500
2516 DR = 1
2520 IF K = 1 THEN 2550
2530 IF K = 2 THEN 2560
2540 IF K = 3 THEN 2570
2550 COLOR= 0: PLOT XB, YB: XB = XB - 1: YB = YB - 1: GOTO 2580
2560 COLOR= 0: PLOT XB, YB: XB =  XB - 1: YB = YB + 1: GOTO 2580
2570 COLOR= 0: PLOT XB, YB: XB  = XB - 1
2580 COLOR= 13: PLOT XB, YB: GOTO 130

2600 REM LOSE GAME
2605 Z = 0
2610 W = PEEK(-16336)
2620 IF Z = 20 THEN 2650
2630 Z = Z + 1
2640 GOTO 2610
2650 PRINT "YOU LOSE"
2660 PRINT "GO AGAIN? (Y OR N)
2665 INPUT N$
2670 IF N$ = "Y" THEN 2691
2680 IF N$ = "N" THEN 2695
2690 IF N$ < > "Y" AND N$ < > "N" THEN 2660
2691 HOME: COLOR= 0: PLOT XB,YB
2692 GOTO 100
2695 TEXT: HOME
2699 END

2700 REM UPSWING
2715 S = 2700
2720 IF DR = 1 THEN 2750
2730 IF DR = 0 THEN 2760
2750 COLOR= 0: PLOT XB, YB: XB = XB - 1: YB = YB -1: GOTO 2780
2760 COLOR= 0: PLOT XB, YB: XB = XB + 1: YB = YB -1: GOTO 2780
2780 COLOR= 13: PLOT XB, YB: GOTO 130

2800 REM DOWNSWING
2815 S = 2800
2820 IF DR = 1 THEN 2850
2830 IF DR = 0 THEN 2860
2850 COLOR= 0: PLOT XB, YB: XB = XB - 1: YB = YB +1: GOTO 2880
2860 COLOR= 0: PLOT XB, YB: XB = XB + 1: YB = YB +1: GOTO 2880
2880 COLOR= 13: PLOT XB, YB: GOTO 130

2900 REM START THE BALL
2910 DR = 1
2920 GOTO 2500

3000 REM PLAY AREA
3100 GR: COLOR= 3: VLIN 0,30 AT 7
3200 COLOR= 12: VLIN 0,30 AT 32
3300 COLOR= 12: HLIN 7, 32 AT 0
3400 COLOR= 12: HLIN 7,32 AT 30
3999 RETURN

4000 GOSUB 2000
4010 GOSUB 2300
4015 S = 4000
4016 DR = 0
4020 IF K = 1 THEN 4050
4030 IF K = 2 THEN 4060
4040 IF K = 3 THEN 4070
4050 COLOR= 0: PLOT XB, YB: XB = XB + 1: YB = YB + 1: GOTO 4080
4060 COLOR= 0: PLOT XB, YB: XB = XB + 1: YB = YB - 1: GOTO 4080
4070 COLOR= 0: PLOT XB, YB: XB = XB + 1
4080 COLOR= 13: PLOT XB,YB: GOTO 130

RUN
